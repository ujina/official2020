---
title: Hexoの投稿をidで管理するのにExcelが便利かも
date: 2017-09-27 10:49:39
tags: [Hexo,WordPress]
id: 0927_1049
categoris: 技術
---

今朝やったことのまとめメモを作っておく。<!--more-->

## ねらい

Hexo でブログを書き始めたことによる初期設定的な悩みです。最初だからこそ将来的に効率がよくなりそう設定を決めておきたいから。


- Hexo の投稿を id で管理していくための環境構築
- パーマリンクも id で運用していくのがよさそう

Wordpress からの移植にあたって id がなにかと使えた。ブラウザから投稿を確認していて気になる箇所に手を入れる際、URLの末尾に見えている id （数桁の数字列）を覚えておいてエディタからファイルにアクセスできた。

投稿内容を想起させる Keyword や　slug ではファイル間の類似性の問題が出てくるし、日付とタイトルを同時に頭に置いてファイルを探すとか全然ムリそう。当面は数百程度の投稿しかないのだから、3桁までの数字列で投稿管理できるようになれば、投稿の手入れもしやすくなりそう。

## 課題

しかし、現状で投稿 id には以下のような問題点がある。 


- WordPres から移植した post にはランダムに id が付番されているが、リビジョンや自動保存機能によって間の抜けた id 番号となっている。
- 300と少しの投稿数なのに、id はすでに3000番台が付与されている。
- id は投稿のマークダウンファイルごとに、フロントマター（投稿内のヘッダのようなもの）に記載されている。
- Hexo 側でidとして付与されるランダムで長い文字列は、使いたくない（なにかのエラーですか？とw）。


## やったこと

作業をすすめた結果、id 番号一覧をエクセルで作成できた。ソートして id 番号として空いている文字列を確認できる状態となったので、紹介。


#### エディタで id: を検索

Hexo の source/_posts 内をエディタで検索をかけて、 id:  の文字列を含むファイルを一覧できる。これを .CSV ファイルとして保存。エディタは Submline Text 2 を使った。

####  エクセルで id: を含む文字列を抽出

上記の .csv ファイルをエクセルで開く。目的の id を含む文字列が 3: id: 1125 のようにセル内に収まっているので、エクセルのフィルター機能でそのセルのみを抽出する。

#### 不要な文字列を削除する

そのセル内から不要な文字列　3: id: を同じくエクセルで取り除く。SUBSTITUTE という関数を用いる。関数処理に成功したセルをドラッグすればすべての対象セルに同じ処理がまたたくまにおこなわれる。Google先生に聞きに行ったら教えてくれるサイトがたくさんある。

#### ソートをかける

2桁から４桁の文字列がずらっとならんだので、昇順にソートをかけた。ここらへんはまさにエクセルでおなじみの処理。

こうして、若い順番にすでに投稿の id として使われている文字列が並んだので、それ以外が空き番号である。空き番号を埋めるように新規投稿への id 付与を行えば「連番」でid番号を付与することも可能。もっとも投稿数が300と少ししかないので、現在3000番台まで振ってあるのは縮小される。


## まとめと感想

投稿の id 番号が連番になっていなくて気持ち悪い、気になる、というのは WordPress でもつきまとうらしく、WordPress での対応法もいくつか見た。結局サーバーのWordPressデータベースにアクセスしていく面倒な作業のように見えた。

静的サイトジェネレーターの場合は、ローカル端末上でテキストベースで扱えたため、このようなエクセルで抽出してソートすることが可能となった。「データが手元にある」感が半端なく、これから投稿に手入れをしていこうという気にもなる。

投稿の id をパーマリンクにするのは WordPress でも設定していたものなので、Hexo でも id  をパーマリンクにして運用する可能性と利便性が高まった。SEO 対策的にどうかという問題もあるようだが、雲をつかむような話しよりは書いている本人が管理しやすかったという実績で決めていくと思う。

静的サイトジェネレーターはこんなところでも「見通しがいい」。
